{"ast":null,"code":"import React,{useEffect,useState}from'react';import FormContainer from\"../components/FormContainer\";import{Button,Card,Col,Form,Image,ListGroup,Row}from\"react-bootstrap\";import{Link}from'react-router-dom';import{useDispatch,useSelector}from\"react-redux\";import{login,register}from\"../actions/userActions\";import Message from\"../components/Message\";import Loader from\"../components/Loader\";import{saveShippingAddress}from\"../actions/cartActions\";import CheckoutSteps from\"../components/checkoutSteps\";import{createOrder}from\"../actions/orderActions\";import{ORDER_CREATE_RESET}from\"../constants/orderConstants\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function PlaceorderScreen(_ref){var history=_ref.history;var orderCreate=useSelector(function(state){return state.orderCreate;});var order=orderCreate.order,error=orderCreate.error,success=orderCreate.success;var dispatch=useDispatch();var cart=useSelector(function(state){return state.cart;});cart.itemsPrice=cart.cartItems.reduce(function(acc,item){return acc+item.price*item.qty;},0).toFixed(2);cart.shippingPrice=(cart.itemsPrice>100?0:10).toFixed(2);cart.taxPrice=Number(0.002*cart.itemsPrice).toFixed(2);cart.totalPrice=(Number(cart.itemsPrice)+Number(cart.shippingPrice)+Number(cart.taxPrice)).toFixed(2);if(!cart.paymentMethod){history.push('/payment');}useEffect(function(){if(success){history.push(\"/order/\".concat(order._id));dispatch({type:ORDER_CREATE_RESET});}},[success,history]);var placeOrder=function placeOrder(){dispatch(createOrder({orderItems:cart.cartItems,shippingAddress:cart.shippingAddress,paymentMethod:cart.paymentMethod,itemsPrice:cart.itemsPrice,shippingPrice:cart.shippingPrice,taxPrice:cart.taxPrice,totalPrice:cart.totalPrice}));};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:8,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"shipping\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Shipping :\"}),cart.shippingAddress.address,\",\",cart.shippingAddress.city,'  ',cart.shippingAddress.postalCode,\",\",'  ',cart.shippingAddress.country]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Method :\"}),cart.paymentMethod]})]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order Items\"}),cart.cartItems.length===0?/*#__PURE__*/_jsx(Message,{variant:\"info\",children:\"Your cart is empty\"}):/*#__PURE__*/_jsx(ListGroup,{variant:\"flush\",children:cart.cartItems.map(function(item,index){return/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:1,children:/*#__PURE__*/_jsx(Image,{src:item.image,alt:item.name,fluid:true,rounded:true})}),/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(Col,{md:4,children:[item.qty,\" x $\",item.price,\" = $\",(item.qty*item.price).toFixed(2)]})]})},index);})})]})]})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Order Summary\"})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Item:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.itemsPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Shipping:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.shippingPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Tax:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.taxPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Total:\"}),/*#__PURE__*/_jsxs(Col,{children:[\"$\",cart.totalPrice]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:error&&/*#__PURE__*/_jsx(Message,{variant:\"danger\",children:error})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Button,{type:\"button\",className:\"btn-block\",disabled:cart.cartItems===0,onClick:placeOrder,children:\"Place Order\"})})]})})})]})]});}export default PlaceorderScreen;","map":{"version":3,"sources":["C:/Users/Amir/Documents/AmirShop2/backend/frontend/src/screens/PlaceorderScreen.js"],"names":["React","useEffect","useState","FormContainer","Button","Card","Col","Form","Image","ListGroup","Row","Link","useDispatch","useSelector","login","register","Message","Loader","saveShippingAddress","CheckoutSteps","createOrder","ORDER_CREATE_RESET","PlaceorderScreen","history","orderCreate","state","order","error","success","dispatch","cart","itemsPrice","cartItems","reduce","acc","item","price","qty","toFixed","shippingPrice","taxPrice","Number","totalPrice","paymentMethod","push","_id","type","placeOrder","orderItems","shippingAddress","address","city","postalCode","country","length","map","index","image","name","product"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\r\nimport FormContainer from \"../components/FormContainer\";\r\nimport {Button, Card, Col, Form, Image, ListGroup, Row} from \"react-bootstrap\";\r\nimport { Link } from 'react-router-dom'\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {login, register} from \"../actions/userActions\";\r\nimport Message from \"../components/Message\";\r\nimport Loader from \"../components/Loader\";\r\nimport {saveShippingAddress} from \"../actions/cartActions\";\r\nimport CheckoutSteps from \"../components/checkoutSteps\";\r\nimport {createOrder} from \"../actions/orderActions\";\r\nimport {ORDER_CREATE_RESET} from \"../constants/orderConstants\";\r\n\r\n\r\nfunction PlaceorderScreen({history}) {\r\n    const orderCreate = useSelector(state=>state.orderCreate)\r\n    const {order,error,success} = orderCreate\r\n    const dispatch = useDispatch()\r\n\r\n    const cart = useSelector(state=>state.cart)\r\n    cart.itemsPrice = cart.cartItems.reduce((acc,item)=>acc+item.price *item.qty,0).toFixed(2)\r\n    cart.shippingPrice = (cart.itemsPrice > 100? 0 : 10).toFixed(2)\r\n    cart.taxPrice = Number((0.002)* cart.itemsPrice).toFixed(2)\r\n    cart.totalPrice = (Number(cart.itemsPrice) + Number(cart.shippingPrice)+Number(cart.taxPrice)).toFixed(2)\r\n    if(!cart.paymentMethod){\r\n        history.push('/payment')\r\n    }\r\n    useEffect(() => {\r\n        if(success){\r\n            history.push(`/order/${order._id}`)\r\n            dispatch({type:ORDER_CREATE_RESET})\r\n        }\r\n\r\n    }, [success,history]);\r\n    \r\n\r\n    const placeOrder=()=>{\r\n        dispatch(createOrder({\r\n            orderItems:cart.cartItems,\r\n            shippingAddress:cart.shippingAddress,\r\n            paymentMethod:cart.paymentMethod,\r\n            itemsPrice:cart.itemsPrice,\r\n            shippingPrice:cart.shippingPrice,\r\n            taxPrice:cart.taxPrice,\r\n            totalPrice:cart.totalPrice,\r\n        }))\r\n    }\r\n    return (\r\n        <div>\r\n            <CheckoutSteps step1 step2 step3 step4 />\r\n            <Row>\r\n                <Col md={8}>\r\n                    <ListGroup variant='flush'>\r\n                        <ListGroup.Item>\r\n                            <h2>shipping</h2>\r\n                            <p>\r\n                                <strong>Shipping :</strong>\r\n                                {cart.shippingAddress.address},{cart.shippingAddress.city}\r\n                                {'  '}\r\n                                {cart.shippingAddress.postalCode},\r\n                                {'  '}\r\n                                {cart.shippingAddress.country}\r\n                            </p>\r\n\r\n                        </ListGroup.Item>\r\n                        <ListGroup.Item>\r\n                            <h2>Payment Method</h2>\r\n                            <p>\r\n                                <strong>Method :</strong>\r\n                                {cart.paymentMethod}\r\n\r\n                            </p>\r\n\r\n                        </ListGroup.Item>\r\n                        <ListGroup.Item>\r\n                            <h2>Order Items</h2>\r\n                            {cart.cartItems.length === 0 ? <Message variant='info'>\r\n                                Your cart is empty\r\n                            </Message> : (\r\n                                <ListGroup variant='flush'>\r\n                                    {cart.cartItems.map((item,index)=>(\r\n                                        <ListGroup.Item key={index}>\r\n                                            <Row>\r\n                                                <Col md={1}>\r\n                                                    <Image src={item.image} alt={item.name} fluid rounded/>\r\n                                                </Col>\r\n                                                <Col>\r\n                                                    <Link to={`/product/${item.product}`}>{item.name}</Link>\r\n                                                </Col>\r\n                                                <Col md={4}>\r\n                                                    {item.qty} x ${item.price} = ${(item.qty * item.price).toFixed(2)}\r\n                                                </Col>\r\n                                            </Row>\r\n                                        </ListGroup.Item>\r\n                                    ))}\r\n                                </ListGroup>\r\n                            )}\r\n                        </ListGroup.Item>\r\n                    </ListGroup>\r\n\r\n                </Col>\r\n                <Col md={4}>\r\n                    <Card>\r\n                        <ListGroup variant='flush'>\r\n                            <ListGroup.Item>\r\n                                <h2>Order Summary</h2>\r\n\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>\r\n                                        Item:\r\n                                    </Col>\r\n                                    <Col>${cart.itemsPrice}</Col>\r\n                                </Row>\r\n\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>\r\n                                        Shipping:\r\n                                    </Col>\r\n                                    <Col>${cart.shippingPrice}</Col>\r\n                                </Row>\r\n\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>\r\n                                        Tax:\r\n                                    </Col>\r\n                                    <Col>${cart.taxPrice}</Col>\r\n                                </Row>\r\n\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Row>\r\n                                    <Col>\r\n                                        Total:\r\n                                    </Col>\r\n                                    <Col>${cart.totalPrice}</Col>\r\n                                </Row>\r\n\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                {error && <Message variant='danger' >{error}</Message>}\r\n                            </ListGroup.Item>\r\n                            <ListGroup.Item>\r\n                                <Button type='button' className='btn-block' disabled={cart.cartItems===0} onClick={placeOrder}>Place Order</Button>\r\n                            </ListGroup.Item>\r\n\r\n                        </ListGroup>\r\n                    </Card>\r\n\r\n                </Col>\r\n            </Row>\r\n\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PlaceorderScreen;"]},"metadata":{},"sourceType":"module"}